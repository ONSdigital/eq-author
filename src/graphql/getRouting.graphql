#import "./fragments/answer.graphql"
#import "./fragments/option.graphql"
#import "./fragments/routing-ruleset.graphql"
#import "./fragments/routing-destination.graphql"

query GetRouting($questionnaireId: ID!, $pageId: ID!, $sectionId: ID!) {
  questionnaire(id: $questionnaireId) {
    id
    sections {
      id
      pages {
        id
        ... on QuestionPage {
          plaintextTitle: title(format: Plaintext)
        }
      }
    }
  }
  section(id: $sectionId) {
    id
    title
    plaintextTitle: title(format: Plaintext)
    pages {
      id
      title
      ... on QuestionPage {
        title
        plaintextTitle: title(format: Plaintext)
        routingRuleSet {
          ...RoutingRuleSet
        }
        answers {
          id
          type
          __typename
          ... on MultipleChoiceAnswer {
            options {
              id
              label
              __typename
            }
            other {
              option {
                id
                label
                __typename
              }
              answer {
                id
                type
                __typename
              }
            }
          }
        }
      }
    }
  }
  questionPage(id: $pageId) {
    id
    plaintextTitle: title(format: Plaintext)
    routingRuleSet {
      ...RoutingRuleSet
    }
    __typename
  }
  availableRoutingDestinations(pageId: $pageId) {
    logicalDestinations {
      ...LogicalDestination
    }
    questionPages {
      ...QuestionPageDestination
    }
    sections {
      ...SectionDestination
    }
  }
}
